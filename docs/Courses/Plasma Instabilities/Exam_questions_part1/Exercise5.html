<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exercise 5: Tearing Mode Instability – Luigi Persico - Ph.D.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-169705d3eabda05963f3986ba613488e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Courses</li><li class="breadcrumb-item">Plasma Instabilities</li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise2.html">Exam Questions Part1</a></li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise5.html">Exercise 5: Tearing Mode Instability</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../project-roadmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ph.D.&nbsp;roadmap</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Plasma Instabilities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Exam Questions Part1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 2: Grad-Shafranov Expansion and Shaping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 3: Linear Ideal MHD and Field Line Bending</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 4: External Kink Mode Stability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exercise 5: Tearing Mode Instability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 6: Ballooning Modes and Weird Curvature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercise 7: Trapped Particles and Fast Ion Stability</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Exam Questions Part2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part2/Exercise4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Three-Wave Coupling and Matching Conditions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions_part2/Exercise5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Derivation of Wave Energy Density</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 1: The Ideal MHD Model and Axisymmetric Equilibria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 2: Grad-Shafranov Solutions - Toroidal and Shaped Equilibria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 3: Theory of Linear Ideal MHD Stability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 4: External Kink Modes and Inertia Treatment</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 5: Linear and Non-linear Tearing Modes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 6: Localised Toroidal Instabilities: Balooning modes and interchange modes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Theory/Chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 7: Fast Ion Effects on Pressure Driven Instabilities</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Papers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../papers/Paper1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Paper1</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">September 2025</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">October 2025</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">November 2025</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">December 2025</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Mathematic Tools</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Bra-ket_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bra-ket notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/covariant_contravariant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Covariant and Contravariant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Hermitian_adjoint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hermitian adjoint</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Hilbert_Space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hilbert Space</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Pauli_matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pauli matrices</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Plasma Physics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/BES.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beam Emission Spectroscopy (BES)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/MSE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motional-Stark Effect (MSE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/NBI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neutral Beam Injector (NBI)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/NBI_simulator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NBI Simulation: Mathematical Model &amp; Code Implementation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Optical_spectrometer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optical Spectrometer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Safety_factor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Safety Factor q</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Diagnostics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Diagnostics/PD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Photodiodes (PD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Diagnostics/thomson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thomson scattering system</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Quantum Physics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Quantum_physics/Quantum_entanglement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quatum Entanglement</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Quantum_physics/Schrödinger_eq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schrödinger Equation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false">
 <span class="menu-text">Useful Guides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-13" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-13" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Useful_guides/Controlling_CMOS_cameras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to control CMOS cameras</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Useful_guides/Controlling_MSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to control MSS</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Courses</li><li class="breadcrumb-item">Plasma Instabilities</li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise2.html">Exam Questions Part1</a></li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions_part1/Exercise5.html">Exercise 5: Tearing Mode Instability</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Exercise 5: Tearing Mode Instability</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="exercise-statement" class="level2">
<h2 class="anchored" data-anchor-id="exercise-statement">Exercise Statement</h2>
<ol start="5" type="1">
<li>The following equations respectively describe the resistive layer width <span class="math inline">\(\delta\)</span> and growth rate for a tearing mode in a cylinder: <span class="math display">\[
\frac{\delta}{r_s} = \left[ \frac{\gamma}{\omega_A n^2 s^2 S} \right]^{1/4}
\]</span> <span class="math display">\[
\frac{\gamma}{\omega_A} = \left[ \frac{\Gamma(1/4) r_s \Delta'}{2\pi \Gamma(3/4)} \right]^{4/5} S^{-3/5} (ns)^{2/5}
\]</span> providing that the constant-psi condition holds: <span class="math display">\[
\delta \Delta' \ll 1. \tag{15}
\]</span></li>
</ol>
<p><strong>(a) Show that,</strong> <span class="math display">\[
\frac{\delta}{r_s} = S^{-2/5} (ns)^{-2/5} \left( \frac{r_s \Delta'}{2.12} \right)^{1/5}
\]</span> and <strong>consider</strong> whether inequality (15) is valid for a typical case where <span class="math inline">\(r_s \Delta' \sim 1\)</span>, <span class="math inline">\(S \sim 10^8\)</span> and <span class="math inline">\(ns \sim 1\)</span>.</p>
<p><strong>(b) Describe</strong> what inequality (15) requires; in particular the length scale of the radial displacement relative to the length scale of the perturbed magnetic flux in the resistive layer region <span class="math inline">\(-\delta &lt; r &lt; \delta\)</span>. <strong>Define</strong> <span class="math inline">\(\Delta'\)</span> in terms of the asymptotes of the perturbed flux in the layer region assuming that (15) is valid.</p>
<p><strong>(c) Explain</strong> how <span class="math inline">\(\Delta'\)</span> can be calculated in order to obtain the growth rate for a tearing mode. For this start with the general equations in the cylinder, <span class="math display">\[
\left( \frac{\gamma}{\omega_A} \right)^2 \left[ \frac{d}{dr} \left( r^3 \frac{d\xi_0^r}{dr} \right) + r\xi_0^r (1-m^2) \right] = - m^2 \frac{R_0}{B_0} \left\{ \left( \frac{n}{m} - \frac{1}{q} \right) \left( r \frac{d}{dr} \left[ r \frac{d}{dr} \delta \psi \right] - m^2 \delta \psi \right) + r \delta \psi \frac{R_0}{B_0} \frac{dJ_{\phi}}{dr} \right\} \quad \text{with} \tag{16}
\]</span> <span class="math display">\[
\xi_0^r = \frac{R_0}{B_0 r} \left( \frac{n}{m} - \frac{1}{q} \right)^{-1} \left[ \delta \psi - \frac{r\eta}{\gamma \mu_0} \nabla^2 \left( \frac{\delta \psi}{r} \right) \right], \tag{17}
\]</span> and <strong>obtain</strong> a simplified differential equation where inertia and resistivity can be neglected. Consider suitable boundary conditions, and matching across the boundaries of the resistive region and ideal regions (where inertia and resistivity can be neglected). <strong>What</strong> determines whether tearing modes are stable or unstable; for example, the degree of non-zero resistivity or the <span class="math inline">\(q\)</span> profile (or equivalently toroidal current profile)?</p>
<hr>
</section>
<section id="solutions" class="level2">
<h2 class="anchored" data-anchor-id="solutions">Solutions</h2>
<section id="solution-a-resistive-layer-width" class="level3">
<h3 class="anchored" data-anchor-id="solution-a-resistive-layer-width">Solution (a): Resistive Layer Width</h3>
<p><strong>1. Substitute the Growth Rate Expression</strong> We start with the expression for the resistive layer width: <span class="math display">\[
\frac{\delta}{r_s} = \left[ \frac{1}{n^2 s^2 S} \cdot \frac{\gamma}{\omega_A} \right]^{1/4}
\]</span> Now substitute the given expression for <span class="math inline">\(\gamma / \omega_A\)</span>: <span class="math display">\[
\frac{\gamma}{\omega_A} = \left[ \frac{\Gamma(1/4) r_s \Delta'}{2\pi \Gamma(3/4)} \right]^{4/5} S^{-3/5} (ns)^{2/5}
\]</span> Numerical factor calculation: Using <span class="math inline">\(\Gamma(1/4) \approx 3.6256\)</span> and <span class="math inline">\(\Gamma(3/4) \approx 1.2254\)</span>: <span class="math display">\[
C = \frac{\Gamma(1/4)}{2\pi \Gamma(3/4)} \approx \frac{3.6256}{2\pi (1.2254)} \approx \frac{3.6256}{7.699} \approx 0.47
\]</span> Wait, let’s look at the target result. The target has a factor <span class="math inline">\(1/2.12\)</span> inside the bracket. Note that <span class="math inline">\(1/0.47 \approx 2.12\)</span>. So the term inside the bracket is indeed <span class="math inline">\((r_s \Delta' / 2.12)\)</span>.</p>
<p>Let’s proceed with the algebraic substitution: <span class="math display">\[
\frac{\delta}{r_s} = \left[ \frac{1}{n^2 s^2 S} \cdot \left( \frac{r_s \Delta'}{2.12} \right)^{4/5} S^{-3/5} (ns)^{2/5} \right]^{1/4}
\]</span></p>
<p><strong>2. Group the Powers</strong> * <strong>Powers of S:</strong> <span class="math display">\[S^{-1} \cdot S^{-3/5} = S^{-8/5}\]</span> Taking the 1/4 root: <span class="math inline">\((S^{-8/5})^{1/4} = S^{-2/5}\)</span>. * <strong>Powers of ns:</strong> We have <span class="math inline">\(n^2 s^2 = (ns)^2\)</span> in the denominator, so <span class="math inline">\((ns)^{-2}\)</span>. Combined with numerator: <span class="math inline">\((ns)^{-2} \cdot (ns)^{2/5} = (ns)^{-10/5 + 2/5} = (ns)^{-8/5}\)</span>. Taking the 1/4 root: <span class="math inline">\(((ns)^{-8/5})^{1/4} = (ns)^{-2/5}\)</span>. * <strong>Powers of</strong> <span class="math inline">\((r_s \Delta' / 2.12)\)</span>: Inside we have the term raised to the power <span class="math inline">\(4/5\)</span>. Taking the 1/4 root: <span class="math inline">\((( \dots )^{4/5})^{1/4} = (\dots)^{1/5}\)</span>.</p>
<p><strong>3. Final Result</strong> Combining these components: <span class="math display">\[
\frac{\delta}{r_s} = S^{-2/5} (ns)^{-2/5} \left( \frac{r_s \Delta'}{2.12} \right)^{1/5}
\]</span></p>
<p><strong>4. Validity Check for Typical Parameters</strong> Given: <span class="math inline">\(r_s \Delta' \sim 1\)</span>, <span class="math inline">\(S \sim 10^8\)</span>, <span class="math inline">\(ns \sim 1\)</span>. Calculate <span class="math inline">\(\delta/r_s\)</span>: <span class="math display">\[
\frac{\delta}{r_s} \sim (10^8)^{-0.4} (1)^{-0.4} (1/2.12)^{0.2}
\]</span> <span class="math display">\[(10^8)^{-0.4} = 10^{-3.2} \approx 6 \times 10^{-4}\]</span> The term <span class="math inline">\((1/2.12)^{0.2}\)</span> is of order unity (<span class="math inline">\(\approx 0.86\)</span>). So, <span class="math inline">\(\delta / r_s \sim 5 \times 10^{-4}\)</span>.</p>
<p>Now check the condition <span class="math inline">\(\delta \Delta' \ll 1\)</span>. Multiply by <span class="math inline">\(r_s\)</span> on both sides to make it dimensionless using <span class="math inline">\(r_s \Delta'\)</span>: <span class="math display">\[(\delta/r_s) \cdot (r_s \Delta') \ll 1\]</span> <span class="math display">\[5 \times 10^{-4} \cdot 1 = 0.0005 \ll 1\]</span> <strong>Conclusion:</strong> Yes, the inequality is valid for these typical parameters. The resistive layer is extremely thin compared to the plasma radius.</p>
<hr>
</section>
<section id="solution-b-constant-psi-condition" class="level3">
<h3 class="anchored" data-anchor-id="solution-b-constant-psi-condition">Solution (b): Constant-Psi Condition</h3>
<p><strong>1. Requirement of Inequality (15)</strong> The inequality <span class="math inline">\(\delta \Delta' \ll 1\)</span> (or equivalently <span class="math inline">\(\Delta' \delta \ll 1\)</span>) is the <strong>Constant-Psi Approximation</strong>. * <strong>Physical Meaning:</strong> It implies that the perturbed magnetic flux <span class="math inline">\(\delta \psi\)</span> is approximately constant across the narrow resistive layer width (<span class="math inline">\(-\delta &lt; x &lt; \delta\)</span>, where <span class="math inline">\(x = r - r_s\)</span>). * <strong>Length Scales:</strong> * From ideal MHD (Eq. 17), outside the layer where <span class="math inline">\(\eta \to 0\)</span>, the radial displacement <span class="math inline">\(\xi_r\)</span> is singular at the resonance. * Inside the layer, <span class="math inline">\(\xi_r\)</span> varies rapidly (from a large value to zero or flipping sign). * <span class="math inline">\(\delta \psi\)</span> varies slowly. The condition <span class="math inline">\(\delta \Delta' \ll 1\)</span> implies that the change in <span class="math inline">\(\psi\)</span> across the layer (<span class="math inline">\(\Delta \psi \sim \delta \cdot \psi'\)</span>) is much smaller than <span class="math inline">\(\psi\)</span> itself. * Therefore, the <strong>length scale of the flux variation</strong> is much larger than the <strong>resistive layer width</strong> <span class="math inline">\(\delta\)</span>.</p>
<p><strong>2. Definition of</strong> <span class="math inline">\(\Delta'\)</span> <span class="math inline">\(\Delta'\)</span> is the <strong>stability index</strong> or discontinuity parameter. It is defined as the jump in the logarithmic derivative of the perturbed flux across the singular surface <span class="math inline">\(r_s\)</span>:</p>
<p><span class="math display">\[
\Delta' = \lim_{\epsilon \to 0} \left[ \frac{1}{\delta \psi(r_s)} \left( \frac{d(\delta \psi)}{dr} \Big|_{r_s + \epsilon} - \frac{d(\delta \psi)}{dr} \Big|_{r_s - \epsilon} \right) \right]
\]</span> This assumes <span class="math inline">\(\delta \psi(r_s)\)</span> is constant (continuous and non-zero) across the layer.</p>
<hr>
</section>
<section id="solution-c-calculating-delta-and-stability" class="level3">
<h3 class="anchored" data-anchor-id="solution-c-calculating-delta-and-stability">Solution (c): Calculating <span class="math inline">\(\Delta'\)</span> and Stability</h3>
<p><strong>1. Simplifying the Equation</strong> We want to calculate <span class="math inline">\(\Delta'\)</span> to find the growth rate. We do this by solving for <span class="math inline">\(\delta \psi\)</span> in the “outer” (ideal) regions where we can neglect inertia (<span class="math inline">\(\gamma \to 0\)</span>) and resistivity (<span class="math inline">\(\eta \to 0\)</span>).</p>
<p>In the ideal region (away from <span class="math inline">\(r_s\)</span>): * <span class="math inline">\(\gamma \approx 0\)</span> means the Left Hand Side (Inertia) of Eq. (16) <span class="math inline">\(\to 0\)</span>. * <span class="math inline">\(\eta \approx 0\)</span> in Eq. (17) simplifies the relation between <span class="math inline">\(\xi\)</span> and <span class="math inline">\(\psi\)</span>.</p>
<p>Setting LHS of (16) to zero: <span class="math display">\[
0 = - m^2 \frac{R_0}{B_0} \left\{ \left( \frac{n}{m} - \frac{1}{q} \right) \left( \nabla_\perp^2 \delta \psi \right) + r \delta \psi \frac{R_0}{B_0} \frac{dJ_{\phi}}{dr} \right\}
\]</span> Note: The term <span class="math inline">\(r \frac{d}{dr} [ r \frac{d}{dr} \delta \psi ] - m^2 \delta \psi\)</span> is the radial part of the Laplacian <span class="math inline">\(\nabla^2 \delta \psi\)</span> (multiplied by <span class="math inline">\(r\)</span>).</p>
<p>Rearranging, we obtain the <strong>Newcomb Equation</strong> (or the exterior tearing mode equation): <span class="math display">\[
\frac{d}{dr} \left( r \frac{d \delta \psi}{dr} \right) - m^2 \delta \psi - \frac{q R_0 \frac{dJ_{\phi}}{dr}}{B_0 (1 - nq/m)} \delta \psi = 0
\]</span> <em>(Note: Using the approximation</em> <span class="math inline">\((n/m - 1/q) \approx (nq - m)/mq\)</span>, the current gradient term simplifies to the form containing the standard tearing drive).</p>
<p><strong>2. Boundary Conditions and Matching</strong> * <strong>Boundary Conditions:</strong> * <span class="math inline">\(r=0\)</span>: <span class="math inline">\(\delta \psi \propto r^m\)</span> (regularity at core). * <span class="math inline">\(r=a\)</span>: <span class="math inline">\(\delta \psi(a)\)</span> matches the vacuum solution (or <span class="math inline">\(\psi(a)=0\)</span> if a wall is on the plasma surface). * <strong>Matching:</strong> We integrate this differential equation numerically or analytically from the center (<span class="math inline">\(r=0\)</span>) out to the singular surface (<span class="math inline">\(r_s^-\)</span>), and from the edge (<span class="math inline">\(r=a\)</span>) in to the singular surface (<span class="math inline">\(r_s^+\)</span>). Since the equation is singular at <span class="math inline">\(r_s\)</span> (where <span class="math inline">\(nq=m\)</span>), the slope <span class="math inline">\(d\psi/dr\)</span> diverges, but we can calculate the slopes as we approach the limit. We compute the jump in the slope: <span class="math display">\[
    \Delta' = \frac{\psi'(r_s^+) - \psi'(r_s^-)}{\psi(r_s)}
    \]</span></p>
<p><strong>3. Stability Determinant</strong> * <strong>What determines stability?</strong> The growth rate <span class="math inline">\(\gamma\)</span> scales with <span class="math inline">\(\Delta'\)</span> (specifically <span class="math inline">\(\gamma \propto (\Delta')^{4/5}\)</span>). * If <span class="math inline">\(\Delta' &gt; 0\)</span>: The mode is <strong>Unstable</strong> (<span class="math inline">\(\gamma &gt; 0\)</span>). * If <span class="math inline">\(\Delta' &lt; 0\)</span>: The mode is <strong>Stable</strong>. * <strong>Role of Resistivity vs.&nbsp;Profile:</strong> * <strong>Resistivity:</strong> It is a <em>necessary</em> condition for the mode to exist (it allows the reconnection at <span class="math inline">\(r_s\)</span>). However, the <em>sign</em> of the stability (stable vs unstable) is NOT determined by the resistivity value. It is determined purely by <span class="math inline">\(\Delta'\)</span>. * <strong>q-profile / Current Profile:</strong> <span class="math inline">\(\Delta'\)</span> is determined entirely by the geometry of the equilibrium fields, specifically the <strong>Current Gradient term</strong> (<span class="math inline">\(dJ_{\phi}/dr\)</span>) and the <span class="math inline">\(q\)</span>-profile in the ideal equation derived above. Therefore, the stability is determined by the macroscopic <strong>toroidal current profile</strong>. * <em>Analogy:</em> Resistivity opens the door (allows breaking field lines), but the current profile pushes the door open (provides the free energy <span class="math inline">\(\Delta'\)</span>).</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>