<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Linear Ideal MHD and Field Line Bending – Luigi Persico - Ph.D.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-169705d3eabda05963f3986ba613488e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked fullcontent quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Courses</li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/01_MHD_model.html">Plasma Instabilities</a></li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise2.html">Exam Questions</a></li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise3.html">Linear Ideal MHD and Field Line Bending</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../project-roadmap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ph.D.&nbsp;roadmap</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Courses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Plasma Instabilities</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/01_MHD_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The MHD model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/02_Grad_Shafranov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grad Shafranov equation</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Exam Questions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth3 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Grad-Shafranov Expansion and Shaping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Linear Ideal MHD and Field Line Bending</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">External Kink Mode Stability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tearing Mode Instability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ballooning Modes and Weird Curvature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Trapped Particles and Fast Ion Stability</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Papers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../papers/Paper1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Paper1</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Reports</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-09.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">September 2025</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">October 2025</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">November 2025</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../reports/2025-12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">December 2025</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Mathematic Tools</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Bra-ket_notation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bra-ket notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/covariant_contravariant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Covariant and Contravariant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Hermitian_adjoint.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hermitian adjoint</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Hilbert_Space.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hilbert Space</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Mathematic_tools/Pauli_matrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pauli matrices</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Plasma Physics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/BES.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beam Emission Spectroscopy (BES)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/MSE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Motional-Stark Effect (MSE)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/NBI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neutral Beam Injector (NBI)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/NBI_simulator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">NBI Simulation: Mathematical Model &amp; Code Implementation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Optical_spectrometer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optical Spectrometer</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Optics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Safety_factor.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Safety Factor q</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">Diagnostics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth3 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Diagnostics/PD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Photodiodes (PD)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Plasma_physics/Diagnostics/thomson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Thomson scattering system</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false">
 <span class="menu-text">Quantum Physics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Quantum_physics/Quantum_entanglement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quatum Entanglement</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Quantum_physics/Schrödinger_eq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schrödinger Equation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">Useful Guides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Useful_guides/Controlling_CMOS_cameras.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to control CMOS cameras</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../theory/Useful_guides/Controlling_MSS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to control MSS</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Courses</li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/01_MHD_model.html">Plasma Instabilities</a></li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise2.html">Exam Questions</a></li><li class="breadcrumb-item"><a href="../../../Courses/Plasma Instabilities/Exam_questions/Exercise3.html">Linear Ideal MHD and Field Line Bending</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Linear Ideal MHD and Field Line Bending</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="exercise-statement" class="level2">
<h2 class="anchored" data-anchor-id="exercise-statement">Exercise Statement</h2>
<ol start="3" type="1">
<li>The linear ideal MHD equations can be written in terms of the displacement variable <span class="math inline">\(\boldsymbol{\xi} = \boldsymbol{\xi}_{\perp} + \xi_{\parallel} \boldsymbol{b}\)</span>. The perturbed magnetic field is, <span class="math display">\[\delta \boldsymbol{B} = \nabla \times (\boldsymbol{\xi} \times \boldsymbol{B}) = \nabla \times (\boldsymbol{\xi}_{\perp} \times \boldsymbol{B}) \tag{7}\]</span></li>
</ol>
<p><strong>(a)</strong> From the definition of Eq. (7), <strong>show</strong> using vector calculus identities that <span class="math display">\[\delta \boldsymbol{B} \cdot \nabla X = (\boldsymbol{B} \cdot \nabla)(\boldsymbol{\xi}_{\perp} \cdot \nabla X) - \nabla \cdot [\boldsymbol{\xi}_{\perp} (\boldsymbol{B} \cdot \nabla X)] \tag{8}\]</span> and in particular the radial contravariant perturbed field is <span class="math display">\[\delta B^r \equiv \delta \boldsymbol{B} \cdot \nabla r = (\boldsymbol{B} \cdot \nabla) \xi^r\]</span></p>
<p><strong>(b)</strong> For the representation of the magnetic field <span class="math inline">\(\boldsymbol{B} = F(r)\nabla \phi + \psi' \nabla \phi \times \nabla r\)</span> <strong>show</strong> that when adopting straight field line coordinates <span class="math inline">\((r, \theta, \phi)\)</span> the magnetic operator <span class="math inline">\(\boldsymbol{B} \cdot \nabla\)</span> can be written as: <span class="math display">\[\boldsymbol{B} \cdot \nabla = \frac{F}{R^2} \left[ \frac{\partial}{\partial \phi} + \frac{1}{q} \frac{\partial}{\partial \theta} \right] \tag{9}\]</span></p>
<p><strong>(c)</strong> Using Eq. (8) and (9) <strong>show</strong> that to leading order in <span class="math inline">\(\epsilon\)</span>, <span class="math display">\[\delta B_0^r = \frac{i B_0}{R_0 q} [nq - m] \xi_0^r\]</span> where <span class="math inline">\(n\)</span> is the toroidal mode number, and you should justify the unique poloidal mode number <span class="math inline">\(m\)</span> appearing in <span class="math inline">\(\delta B^r\)</span>. <strong>Comment</strong> on the value of <span class="math inline">\(\delta B_0^r\)</span> on a rational surface.</p>
<p><strong>(d)</strong> Quote the lowest order solution for the perturbed poloidal magnetic field and <strong>consider</strong> whether magnetic field line bending necessarily vanishes on a rational surface for sheared and unsheared plasmas? <strong>Does</strong> magnetic shear improve plasma stability if low order rational surfaces can’t be avoided?</p>
<hr>
</section>
<section id="solutions" class="level2">
<h2 class="anchored" data-anchor-id="solutions">Solutions</h2>
<section id="solution-a-vector-identities" class="level3">
<h3 class="anchored" data-anchor-id="solution-a-vector-identities">Solution (a): Vector Identities</h3>
<p><strong>1. General Identity</strong> We start with the perturbed magnetic field equation: <span class="math display">\[\delta \boldsymbol{B} = \nabla \times (\boldsymbol{\xi}_{\perp} \times \boldsymbol{B})\]</span> Using the vector identity for the curl of a cross product: <span class="math display">\[\nabla \times (\boldsymbol{A} \times \boldsymbol{B}) = (\boldsymbol{B} \cdot \nabla)\boldsymbol{A} - (\boldsymbol{A} \cdot \nabla)\boldsymbol{B} + \boldsymbol{A}(\nabla \cdot \boldsymbol{B}) - \boldsymbol{B}(\nabla \cdot \boldsymbol{A})\]</span> Substitute <span class="math inline">\(\boldsymbol{A} = \boldsymbol{\xi}_{\perp}\)</span> and note that <span class="math inline">\(\nabla \cdot \boldsymbol{B} = 0\)</span>: <span class="math display">\[\delta \boldsymbol{B} = (\boldsymbol{B} \cdot \nabla)\boldsymbol{\xi}_{\perp} - (\boldsymbol{\xi}_{\perp} \cdot \nabla)\boldsymbol{B} - \boldsymbol{B}(\nabla \cdot \boldsymbol{\xi}_{\perp})\]</span></p>
<p>Now, we take the dot product with <span class="math inline">\(\nabla X\)</span> (where <span class="math inline">\(X\)</span> is an arbitrary scalar): <span class="math display">\[\delta \boldsymbol{B} \cdot \nabla X = [(\boldsymbol{B} \cdot \nabla)\boldsymbol{\xi}_{\perp}] \cdot \nabla X - [(\boldsymbol{\xi}_{\perp} \cdot \nabla)\boldsymbol{B}] \cdot \nabla X - (\boldsymbol{B} \cdot \nabla X)(\nabla \cdot \boldsymbol{\xi}_{\perp})\]</span></p>
<p>We compare this to the desired Right Hand Side (RHS) of Eq. (8): <span class="math display">\[\text{RHS} = (\boldsymbol{B} \cdot \nabla)(\boldsymbol{\xi}_{\perp} \cdot \nabla X) - \nabla \cdot [\boldsymbol{\xi}_{\perp} (\boldsymbol{B} \cdot \nabla X)]\]</span> Expanding the first term of the RHS using the chain rule: <span class="math display">\[(\boldsymbol{B} \cdot \nabla)(\boldsymbol{\xi}_{\perp} \cdot \nabla X) = [(\boldsymbol{B} \cdot \nabla)\boldsymbol{\xi}_{\perp}] \cdot \nabla X + \boldsymbol{\xi}_{\perp} \cdot [(\boldsymbol{B} \cdot \nabla)\nabla X]\]</span> Expanding the second term of the RHS: <span class="math display">\[\nabla \cdot [\boldsymbol{\xi}_{\perp} (\boldsymbol{B} \cdot \nabla X)] = (\boldsymbol{B} \cdot \nabla X)(\nabla \cdot \boldsymbol{\xi}_{\perp}) + \boldsymbol{\xi}_{\perp} \cdot \nabla (\boldsymbol{B} \cdot \nabla X)\]</span></p>
<p>Substituting these back into the RHS expression, the terms involving second derivatives of <span class="math inline">\(X\)</span> cancel out (specifically <span class="math inline">\(\boldsymbol{\xi}_{\perp} \cdot [(\boldsymbol{B} \cdot \nabla)\nabla X]\)</span> and <span class="math inline">\(\boldsymbol{\xi}_{\perp} \cdot \nabla (\boldsymbol{B} \cdot \nabla X)\)</span> are symmetric and cancel). We recover exactly the expression for <span class="math inline">\(\delta \boldsymbol{B} \cdot \nabla X\)</span> derived above. Thus, Eq. (8) is proven.</p>
<p><strong>2. Radial Contravariant Field</strong> We apply Eq. (8) with <span class="math inline">\(X = r\)</span> (the radial coordinate): <span class="math display">\[\delta B^r = \delta \boldsymbol{B} \cdot \nabla r = (\boldsymbol{B} \cdot \nabla)(\boldsymbol{\xi}_{\perp} \cdot \nabla r) - \nabla \cdot [\boldsymbol{\xi}_{\perp} (\boldsymbol{B} \cdot \nabla r)]\]</span> Since <span class="math inline">\(\boldsymbol{B}\)</span> lies on flux surfaces, it is perpendicular to the radial gradient: <span class="math inline">\(\boldsymbol{B} \cdot \nabla r = 0\)</span>. The second term vanishes entirely. We define <span class="math inline">\(\xi^r = \boldsymbol{\xi}_{\perp} \cdot \nabla r\)</span>. <span class="math display">\[\delta B^r = (\boldsymbol{B} \cdot \nabla) \xi^r\]</span></p>
</section>
<section id="solution-b-magnetic-operator" class="level3">
<h3 class="anchored" data-anchor-id="solution-b-magnetic-operator">Solution (b): Magnetic Operator</h3>
<p>We are given the field representation: <span class="math display">\[\boldsymbol{B} = F(r)\nabla \phi + \psi' \nabla \phi \times \nabla r\]</span> The gradient operator in general coordinates is <span class="math inline">\(\nabla = \nabla \phi \frac{\partial}{\partial \phi} + \nabla \theta \frac{\partial}{\partial \theta} + \nabla r \frac{\partial}{\partial r}\)</span>. We compute the operator <span class="math inline">\(\boldsymbol{B} \cdot \nabla\)</span>: <span class="math display">\[\boldsymbol{B} \cdot \nabla = (\boldsymbol{B} \cdot \nabla \phi) \frac{\partial}{\partial \phi} + (\boldsymbol{B} \cdot \nabla \theta) \frac{\partial}{\partial \theta} + (\boldsymbol{B} \cdot \nabla r) \frac{\partial}{\partial r}\]</span></p>
<ol type="1">
<li><strong>Radial component:</strong> As established, <span class="math inline">\(\boldsymbol{B} \cdot \nabla r = 0\)</span>.</li>
<li><strong>Toroidal component:</strong> <span class="math display">\[\boldsymbol{B} \cdot \nabla \phi = F(r) |\nabla \phi|^2 + \psi' (\nabla \phi \times \nabla r) \cdot \nabla \phi\]</span> The cross product term is zero (vector orthogonal to itself). In axisymmetric coordinates, <span class="math inline">\(|\nabla \phi|^2 = 1/R^2\)</span>. <span class="math display">\[\boldsymbol{B} \cdot \nabla \phi = \frac{F}{R^2}\]</span></li>
<li><strong>Poloidal component:</strong> In <strong>straight field line coordinates</strong>, the field lines appear straight in the <span class="math inline">\(\theta\)</span>-<span class="math inline">\(\phi\)</span> plane. The pitch of the field lines is defined by the safety factor <span class="math inline">\(q(r)\)</span>: <span class="math display">\[\frac{\boldsymbol{B} \cdot \nabla \phi}{\boldsymbol{B} \cdot \nabla \theta} = q(r)\]</span> Therefore: <span class="math display">\[\boldsymbol{B} \cdot \nabla \theta = \frac{1}{q} (\boldsymbol{B} \cdot \nabla \phi) = \frac{F}{R^2 q}\]</span></li>
</ol>
<p>Substituting these coefficients back into the operator: <span class="math display">\[\boldsymbol{B} \cdot \nabla = \frac{F}{R^2} \frac{\partial}{\partial \phi} + \frac{F}{R^2 q} \frac{\partial}{\partial \theta} = \frac{F}{R^2} \left[ \frac{\partial}{\partial \phi} + \frac{1}{q} \frac{\partial}{\partial \theta} \right]\]</span></p>
</section>
<section id="solution-c-perturbed-radial-field" class="level3">
<h3 class="anchored" data-anchor-id="solution-c-perturbed-radial-field">Solution (c): Perturbed Radial Field</h3>
<p>We assume a Fourier perturbation of the form <span class="math inline">\(\xi^r \sim \xi_0^r e^{i(n\phi - m\theta)}\)</span>. (Note: The sign convention in the result <span class="math inline">\([nq - m]\)</span> implies dependence <span class="math inline">\(\sim e^{in\phi - im\theta}\)</span>).</p>
<p>Using the result from (a) <span class="math inline">\(\delta B^r = (\boldsymbol{B} \cdot \nabla) \xi^r\)</span> and the operator from (b): <span class="math display">\[\delta B^r = \frac{F}{R^2} \left[ \frac{\partial}{\partial \phi} + \frac{1}{q} \frac{\partial}{\partial \theta} \right] \xi_0^r e^{i(n\phi - m\theta)}\]</span> Applying the derivatives (<span class="math inline">\(\partial_\phi \to in\)</span>, <span class="math inline">\(\partial_\theta \to -im\)</span>): <span class="math display">\[\delta B^r = \frac{F}{R^2} \left[ i n - \frac{i m}{q} \right] \xi^r = \frac{i F}{R^2 q} [nq - m] \xi^r\]</span></p>
<p><strong>Leading Order Approximation:</strong> For large aspect ratio tokamaks: * <span class="math inline">\(R \approx R_0\)</span> * <span class="math inline">\(F(r) \approx R_0 B_0\)</span> (The toroidal field function is dominated by the vacuum field). Substituting these: <span class="math display">\[\frac{F}{R^2} \approx \frac{R_0 B_0}{R_0^2} = \frac{B_0}{R_0}\]</span> Thus: <span class="math display">\[\delta B_0^r = \frac{i B_0}{R_0 q} [nq - m] \xi_0^r\]</span></p>
<p><strong>Justification for <span class="math inline">\(m\)</span>:</strong> In the large aspect ratio (cylindrical) limit, the equilibrium is symmetric in <span class="math inline">\(\theta\)</span>. The poloidal harmonics decouple, meaning equations can be solved for a single unique <span class="math inline">\(m\)</span> mode independently.</p>
<p><strong>Comment on Rational Surface:</strong> A rational surface is defined where <span class="math inline">\(q(r) = m/n\)</span>. At this location, the term <span class="math inline">\([nq - m]\)</span> becomes zero. Consequently, <strong><span class="math inline">\(\delta B^r = 0\)</span> on the rational surface.</strong> This implies that in ideal MHD, the radial magnetic field perturbation vanishes at the resonance, preserving the magnetic topology (no magnetic island formation/reconnection).</p>
</section>
<section id="solution-d-stability-and-shear" class="level3">
<h3 class="anchored" data-anchor-id="solution-d-stability-and-shear">Solution (d): Stability and Shear</h3>
<p><strong>Lowest Order Solution:</strong> As derived above: <span class="math inline">\(\delta B_0^r \propto (nq - m) \xi_0^r\)</span>.</p>
<p><strong>Field Line Bending:</strong> The “field line bending” term is the restoring force in the potential energy <span class="math inline">\(\delta W\)</span> arising from the tension of the magnetic field lines. It is proportional to the parallel gradient of the perturbation: <span class="math inline">\((\boldsymbol{B} \cdot \nabla)\boldsymbol{\xi} \propto (nq - m)\)</span>.</p>
<ul>
<li><strong>Rational Surfaces:</strong> On a rational surface (<span class="math inline">\(q = m/n\)</span>), this term vanishes. The field lines do not “bend” in response to the perturbation because the perturbation helix matches the field line pitch. This removes the stabilizing tension force at that specific radius.</li>
</ul>
<p><strong>Sheared vs.&nbsp;Unsheared Plasmas:</strong> 1. <strong>Unsheared (<span class="math inline">\(q = \text{const}\)</span>):</strong> If the plasma is unsheared and <span class="math inline">\(q = m/n\)</span> everywhere (or over a large region), the stabilizing term <span class="math inline">\((nq-m)\)</span> vanishes globally. The plasma loses magnetic tension stabilization over the whole volume, making it highly unstable to helical distortions (kink modes). 2. <strong>Sheared (<span class="math inline">\(q' \neq 0\)</span>):</strong> If the plasma has shear, the resonance condition <span class="math inline">\(q(r) = m/n\)</span> is only satisfied at a specific radius (the rational surface). Away from this surface, <span class="math inline">\(|nq - m|\)</span> grows, and the field line bending term becomes non-zero.</p>
<p><strong>Does Shear Improve Stability?</strong> <strong>Yes.</strong> Magnetic shear localizes the region where the stabilizing field line bending force vanishes. Even if low-order rational surfaces cannot be avoided, shear ensures that the instability is essentially “pinned” or stabilized by the magnetic tension in the regions immediately surrounding the rational surface. This makes it much harder for global modes to grow compared to the shearless case.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>